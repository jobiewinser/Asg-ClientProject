<!doctype html>
<html class="fixed">
<head>

    <!-- Basic -->
    <meta charset="UTF-8">

    <meta name="keywords" content="HTML5 Admin Template" />
    <meta name="description" content="Porto Admin - Responsive HTML5 Template">
    <meta name="author" content="okler.net">

    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <!-- Web Fonts  -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800|Shadows+Into+Light" rel="stylesheet" type="text/css">

    <!-- Vendor CSS -->
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.css" />
    <link rel="stylesheet" href="../assets/vendor/font-awesome/css/font-awesome.css" />
    <link rel="stylesheet" href="../assets/vendor/magnific-popup/magnific-popup.css" />
    <link rel="stylesheet" href="../assets/vendor/bootstrap-datepicker/css/datepicker3.css" />

    <!-- Theme CSS -->
    <link rel="stylesheet" href="../assets/stylesheets/theme.css" />

    <!-- Skin CSS -->
    <link rel="stylesheet" href="../assets/stylesheets/skins/default.css" />

    <!-- Theme Custom CSS -->
    <link rel="stylesheet" href="../assets/stylesheets/theme-custom.css">

    <!-- Head Libs -->
    <script src="../assets/vendor/modernizr/modernizr.js"></script>

</head>
<body>
<!-- start: page -->
<section class="body-sign">
    <div class="center-sign">

        <div class="panel panel-sign">
            <div class="panel-body">
                <form method="post" id="registration-form" action="/api/v1/account/register">
                    <div class="form-group mb-lg">
                        <label for="forename">Forename *</label>
                        <input id="forename" name="forename" type="text" class="form-control input-lg" required />
                    </div>

                    <div class="form-group mb-lg">
                        <label for="surname">Surname *</label>
                        <input id="surname" name="surname" type="text" class="form-control input-lg" required />
                    </div>

                    <div class="form-group mb-lg">
                        <label for="phone-number">Phone Number</label>
                        <input id="phone-number" name="phoneNumber" type="number" class="form-control input-lg" />
                    </div>

                    <div class="form-group mb-lg">
                        <label for="email">E-mail Address *</label>
                        <input id="email" name="email" type="email" class="form-control input-lg" required />
                    </div>

                    <div class="form-group mb-none">
                        <div class="row">
                            <div class="col-sm-6 mb-lg">
                                <label for="password">Password *</label>
                                <input id="password" name="password" type="password" class="form-control input-lg" required />
                            </div>
                            <div class="col-sm-6 mb-lg">
                                <label for="confirm-password">Password Confirmation *</label>
                                <input id="confirm-password" name="confirmPassword" type="password" class="form-control input-lg" required />
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-8">
                            <div class="checkbox-custom checkbox-default">
                                <input id="agree-terms" name="agreeterms" type="checkbox"/>
                                <label for="agree-terms">I agree with <a href="#">terms of use</a></label>
                            </div>
                        </div>
                        <div class="col-sm-4 text-right">
                            <button type="submit" class="btn btn-primary hidden-xs">Sign Up</button>
                            <button type="submit" class="btn btn-primary btn-block btn-lg visible-xs mt-lg">Sign Up</button>
                        </div>
                    </div>

                    <p class="text-center">Already have an account? <a href="/account/login">Login</a>

                </form>
            </div>
        </div>

        <div class="alert alert-danger" id="passwords-unmatched" style="display: none;" role="alert">
            The passwords don't match.
        </div>

        <div class="alert alert-danger" id="terms-unnaccepted" style="display: none;" role="alert">
            You must accept the terms and conditions to proceed!
        </div>

        <p class="alert alert-danger" id="conflict" style="display: none;" role="alert"></p>

        <div class="alert alert-danger" id="error" style="display: none;" role="alert">
            There was an error registering please try again later!
        </div>

        <p class="text-center text-muted mt-md mb-md">&copy; Copyright 2018. All rights reserved. Template by <a href="https://colorlib.com">Colorlib</a>.</p>
    </div>
</section>
<!-- end: page -->

<!-- Vendor -->
<script src="../assets/vendor/jquery/jquery.js"></script>
<script src="../assets/vendor/jquery-browser-mobile/jquery.browser.mobile.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.js"></script>
<script src="../assets/vendor/nanoscroller/nanoscroller.js"></script>
<script src="../assets/vendor/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script src="../assets/vendor/magnific-popup/magnific-popup.js"></script>
<script src="../assets/vendor/jquery-placeholder/jquery.placeholder.js"></script>

<!-- Theme Base, Components and Settings -->
<script src="../assets/javascripts/theme.js"></script>

<!-- Theme Custom -->
<script src="../assets/javascripts/theme.custom.js"></script>

<!-- Theme Initialization Files -->
<script src="../assets/javascripts/theme.init.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.js"></script>

<script>
    $(function register(event)
    {
        $("#registration-form").on("submit", function(event) {
            var tAndCError = $("#terms-unnaccepted");
            var passwordError = $("#passwords-unmatched");
            var conflictError = $("#conflict");
            conflictError.css("display", "none");
            tAndCError.css("display", "none");
            passwordError.css("display", "none");
            $("#error").css('display', 'none');

            var forename = $("#forename").val();
            var surname = $("#surname").val();
            var phoneNumber = $("#phone-number").val();
            var email = $("#email").val();
            var password = $("#password").val();
            var confirmPassword = $("#confirm-password").val();

            var areTermsAndConditionsAccepted = $("#agree-terms").is(":checked");

            if (!areTermsAndConditionsAccepted) {
                tAndCError.css("display", "block");
            } else {
                if (password !== confirmPassword) {
                    passwordError.css("display", "block");
                } else {
                    axios.post("/api/v1/account/register", {
                        forename: forename,
                        surname: surname,
                        phoneNumber: phoneNumber,
                        email: email,
                        password: password,
                        confirmPassword: confirmPassword
                    })
                    .then(function (response) {
                        window.location.href = "/account/login";
                    })
                    .catch(function (error) {
                        if (error.response.status !== 409) {
                            $("#error").css('display', 'block');
                        } else {
                            var conflictError = $("#conflict");
                            conflictError.text(error.response.data);
                            conflictError.css("display", "block");
                        }
                    });
                }
            }
            event.preventDefault();
        });
    });
</script>
</body>
</html>